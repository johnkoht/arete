---
title: Publish Areté to npm Registry
slug: publish-to-npm
status: draft
size: medium
tags: [distribution, npm, publish]
created: 2026-02-23T19:31:00.000Z
updated: 2026-02-25T22:57:00.000Z
completed: null
execution: null
has_review: false
has_pre_mortem: true
has_prd: false
steps: 8
---

# Phase 2: Publish Areté to npm Registry

## Goal

Publish Areté as a single npm package so product managers and builders can install it globally from the npm registry.

```bash
npm install -g arete-workspace
arete install ~/my-workspace
```

## Prerequisite

**Phase 1 (`publish-arete`) must be complete.** Phase 1 fixes:
- `workspace:*` dependency → `file:./packages/core`
- `getSourcePaths()` to always use `packages/runtime/`
- Dependency mismatch (`inquirer` → `@inquirer/prompts`)

These fixes are required for npm publish to work.

## Context

- The repo is a 3-package monorepo (core, cli, runtime) but only the ROOT package publishes to npm
- `packages/core` and `packages/cli` remain internal (marked private) — users never install them directly
- `packages/runtime` contains the workspace content (skills, rules, tools, templates) that gets copied into the user's workspace on `arete install`
- `arete-workspace` is confirmed available on npmjs.com

## Package Architecture (post-publish)

```
arete-workspace (published to npm)
  ├── bin/arete.js              ← CLI entrypoint
  ├── packages/core/dist/       ← compiled engine (baked in)
  ├── packages/cli/dist/        ← compiled CLI commands (baked in)
  └── packages/runtime/         ← skills, rules, tools, templates
```

Users install one package → get the `arete` command → run `arete install` → runtime content lands in their workspace.

## Size

Medium (8 steps)

---

## Steps

### Step 1 — Fix root `package.json` for npm publish

- Rename: `@arete/cli` → `arete-workspace`
- Fix `bin`: `./packages/cli/bin/arete.js` (verify this path resolves post-install)
- Fix `files` array: ensure it includes all compiled output and runtime assets
  - **Add `packages/cli/dist/`** — currently missing; the bin entry imports from here and it won't resolve without it
  - **Remove `dist/` from `files`** — root `dist/` is stale (last built Feb 15), never auto-generated by `npm run build`, and would be absent on a clean checkout publish. `packages/runtime/` is the correct source of truth and is already in `files`
  - **Remove `AGENTS.md` from `files`** — this is the BUILD version with internal dev conventions. Only `dist/AGENTS.md` (GUIDE version) should ship, and that lives under `packages/runtime/` now
- Add `publishConfig: { access: "public" }`
- Add `description`, `keywords`, `repository`, `homepage`, `bugs` metadata
- Bump `engines.node` from `>=18.0.0` to `>=20.0.0` (Node 18 EOL was April 2025)
- Add `exports` field for proper ESM entry point resolution
- Update `prepublishOnly` to include tests: `"npm run build && npm test"`

**Acceptance Criteria:**
- [ ] Package name is `arete-workspace`
- [ ] `files` array includes: `packages/cli/bin/`, `packages/cli/dist/`, `packages/core/dist/`, `packages/runtime/`
- [ ] `files` array excludes: `dist/`, `AGENTS.md`
- [ ] `publishConfig.access` is `"public"`
- [ ] `engines.node` is `>=20.0.0`

### Step 2 — Fix `packages/cli/package.json`

- Rename: `@arete/cli-next` → `@arete/cli`
- Add `private: true` (prevents accidental separate publish)
- Add `files` field

**Acceptance Criteria:**
- [ ] `private: true` present
- [ ] Name is `@arete/cli`

### Step 3 — Fix `packages/runtime/package.json`

- Add `private: true`
- Add `files` field (only ship skills/, rules/, tools/, templates/, GUIDE.md)
- Add `description` and `keywords`

**Acceptance Criteria:**
- [ ] `private: true` present

### Step 4 — Fix `packages/core/package.json`

- Add `private: true`
- Verify `files` field covers `dist/` output

**Acceptance Criteria:**
- [ ] `private: true` present

### Step 5 — Add CHANGELOG.md

- Create `CHANGELOG.md` at root
- Document v0.1.0 as initial release with high-level feature summary
- Include in `files` array so it ships with the package

**Acceptance Criteria:**
- [ ] `CHANGELOG.md` exists
- [ ] Documents v0.1.0 release
- [ ] Listed in `files` array

### Step 6 — Build + quality gates

```bash
npm run build      # compiles all packages
npm run typecheck  # must pass
npm test           # must pass
```

**Acceptance Criteria:**
- [ ] `npm run build` succeeds
- [ ] `npm run typecheck` passes with no errors
- [ ] `npm test` passes with no failures

### Step 7 — Dry-run verify

```bash
npm pack --dry-run
```

Review the output:
- Confirm runtime assets ship (skills/, tools/, rules/, templates/)
- No dev files leak (no test/, no .cursor/, no dev/)
- Bin path is correct
- No stale `dist/` files or BUILD-only artifacts in tarball
- Check package size is reasonable (< 5MB expected)
- Verify `@arete/core` bare imports resolve (check tarball contents)

**Acceptance Criteria:**
- [ ] Tarball includes `packages/runtime/skills/`
- [ ] Tarball excludes `test/`, `.cursor/`, `dev/`
- [ ] Tarball excludes root `dist/` and root `AGENTS.md`
- [ ] Package size < 5MB

### Step 8 — Publish (owner executes manually)

```bash
npm login          # verify logged in as correct account
npm publish --access public
npm view arete-workspace  # verify published
```

Then test clean install:
```bash
cd /tmp
npm install -g arete-workspace
arete --version
arete install ./test-workspace
```

**Acceptance Criteria:**
- [ ] `npm view arete-workspace` returns package metadata
- [ ] Global install works
- [ ] `arete --version` works
- [ ] `arete install` creates working workspace

---

## Definition of Done

- [ ] `npm view arete-workspace` returns the correct package metadata
- [ ] `npm install -g arete-workspace` installs cleanly
- [ ] `arete --version` works after install
- [ ] `arete install` can scaffold a workspace (runtime assets present)
- [ ] Quality gates pass (`typecheck` + `test`)
- [ ] No dev files, test files, or BUILD-only artifacts in the published package
- [ ] `CHANGELOG.md` exists and documents v0.1.0
- [ ] All dependencies in `package.json` match actual imports (no phantom deps)

---

## Out of Scope (future work)

- GitHub Actions CI/CD for automated publish on git tag
- Changelog / versioning automation (changesets, release-please)
- npm page README polish / badges
- `@arete/core` as a separately published package for programmatic use
- One-page marketing/landing site
