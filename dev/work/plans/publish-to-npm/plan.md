---
title: Publish arete-workspace to npmjs
slug: publish-to-npm
status: draft
size: medium
created: 2026-02-17T21:00:00Z
updated: 2026-02-23T03:30:00.000Z
completed: null
has_review: false
has_pre_mortem: false
has_prd: false
steps: 7
tags: []
---

# Publish arete-workspace to npmjs

## Goal

Publish Arete as a single npm package (`arete-workspace`) so product managers and builders can install it globally and use the `arete` CLI to set up their workspace.

```
npm install -g arete-workspace
arete install ~/my-workspace
```

## Context

- The repo is a 3-package monorepo (core, cli, runtime) but only the ROOT package publishes to npm
- `packages/core` and `packages/cli` remain internal (marked private) — users never install them directly
- `packages/runtime` contains the workspace content (skills, rules, tools, templates) that gets copied into the user's workspace on `arete install`
- `arete-workspace` is confirmed available on npmjs.com

## Package Architecture (post-publish)

```
arete-workspace (published to npm)
  ├── bin/arete.js              ← CLI entrypoint
  ├── packages/core/dist/       ← compiled engine (baked in)
  ├── packages/cli/dist/        ← compiled CLI commands (baked in)
  └── packages/runtime/         ← skills, rules, tools, templates
```

Users install one package → get the `arete` command → run `arete install` → runtime content lands in their workspace.

## Steps

### Step 1 — Fix root `package.json`
- Rename: `@arete/cli` → `arete-workspace`
- Fix `bin`: `./packages/cli/bin/arete.js` (verify this path resolves post-install)
- Fix `files` array: ensure it includes all compiled output and runtime assets
  - **Add `packages/cli/dist/`** — currently missing; the bin entry imports from here and it won't resolve without it
  - **Remove `dist/` from `files`** — root `dist/` is stale (last built Feb 15), never auto-generated by `npm run build`, and would be absent on a clean checkout publish. `packages/runtime/` is the correct source of truth and is already in `files`
  - **Remove `AGENTS.md` from `files`** — this is the BUILD version with internal dev conventions. Only `dist/AGENTS.md` (GUIDE version) should ship, and that lives under `packages/runtime/` now
- Fix `workspace:*` dependency on `@arete/core` → `"*"` (npm doesn't support workspace protocol)
- Add `publishConfig: { access: "public" }`
- Add `author`: `"John Koht"`
- Add `description`, `keywords`, `repository`, `homepage`, `bugs` metadata
- Fix dependency mismatch: replace `inquirer` with `@inquirer/prompts` in dependencies (CLI code uses `@inquirer/prompts`, not the monolithic `inquirer` package)
- Bump `engines.node` from `>=18.0.0` to `>=20.0.0` (Node 18 EOL was April 2025)
- Add `exports` field for proper ESM entry point resolution
- Update `prepublishOnly` to include tests: `"npm run build && npm test"`

> **Note — `getSourcePaths()` must be updated alongside the `files` fix.** Currently `getSourcePaths()` in `packages/core/src/compat/workspace.ts` resolves to `dist/` when `useRuntime = false` (i.e. when the package root path contains `node_modules`, which is the npm install path). With `dist/` removed, this would silently skip copying skills/tools/rules for npm users. Fix: update the condition so it always resolves to `packages/runtime/` when that directory exists, regardless of whether `node_modules` is in the path. The `useRuntime` flag can be dropped entirely once `packages/runtime/` is the single source of truth.

### Step 2 — Fix `packages/cli/package.json`
- Rename: `@arete/cli-next` → `@arete/cli`
- Add `private: true` (prevents accidental separate publish)
- Add `files` field

### Step 3 — Fix `packages/runtime/package.json`
- Add `private: true`
- Add `files` field (only ship skills/, rules/, tools/, templates/, GUIDE.md)
- Add `description` and `keywords`

### Step 4 — Fix `packages/core/package.json`
- Add `private: true`
- Verify `files` field covers `dist/` output

### Step 5 — Add CHANGELOG.md
- Create `CHANGELOG.md` at root
- Document v0.1.0 as initial release with high-level feature summary
- Include in `files` array so it ships with the package

### Step 6 — Build + quality gates
- `npm run build` (compiles all packages)
- `npm run typecheck` (must pass)
- `npm test` (must pass)

### Step 7 — Dry-run verify
- `npm pack --dry-run` from root
- Review file list: confirm runtime assets ship, no dev files leak, bin path is correct
- Verify no stale `dist/` files or BUILD-only artifacts in tarball
- Check package size is reasonable
- Verify `@arete/core` bare imports resolve (grep tarball contents)

### Step 8 — Publish (owner executes)
- `npm login` (verify logged in as correct account)
- `npm publish --access public`
- Verify: `npm view arete-workspace`
- Test clean install: `npm install -g arete-workspace` in a temp dir
- Test: `arete --version`, `arete install` in a fresh directory

## Out of Scope (follow-up plans)
- GitHub Actions CI/CD for automated publish on git tag
- Changelog / versioning automation (changesets, release-please)
- npm page README polish / badges
- `@arete/core` as a separately published package for programmatic use
- One-page marketing/landing site

## Definition of Done
- [ ] `npm view arete-workspace` returns the correct package metadata
- [ ] `npm install -g arete-workspace` installs cleanly
- [ ] `arete --version` works after install
- [ ] `arete install` can scaffold a workspace (runtime assets present)
- [ ] Quality gates pass (`typecheck` + `test`)
- [ ] No dev files, test files, or BUILD-only artifacts in the published package
- [ ] `CHANGELOG.md` exists and documents v0.1.0
- [ ] All dependencies in `package.json` match actual imports (no phantom deps)
