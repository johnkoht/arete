---
description: When in Plan Mode or multi-step plans, conduct a pre-mortem before execution
globs: ["src/**/*", "test/**/*", ".cursor/build/**/*"]
alwaysApply: true
---

# Plan Mode: Pre-Mortem Required

**Only when in Build Context (BUILDER mode).** See `arete-context.mdc`. Ignore in GUIDE mode or end-user workspaces.

## When This Applies

You **must** conduct a pre-mortem when **any** of these are true:

- The user started the agent in **Plan Mode** (Cursor’s plan-before-execute flow, e.g. Shift+Tab).
- You have created or are creating a **multi-step execution plan** (e.g. a markdown plan with 3+ steps, file paths, and code references).
- The work is **PRD execution**, a **large refactor**, a **new system**, or **integration work** across multiple components.

If the work is a single, well-understood task, a pre-mortem is optional.

## What to Do

**After** you have a draft plan and **before** you start executing it:

1. **Run a pre-mortem** using the same process as the execute-prd skill:
   - Read `.cursor/build/templates/PRE-MORTEM-TEMPLATE.md` for the format and risk categories.
   - Consider the **8 risk categories**: Context Gaps, Test Patterns, Integration, Scope Creep, Code Quality, Dependencies, Platform Issues, State Tracking.
   - For each relevant risk: **Problem** (what could go wrong), **Mitigation** (concrete action), **Verification** (how to check it was applied).

2. **Present** the risks and mitigations to the user (e.g. a short table or list).

3. **Get approval** (e.g. “Proceed with these mitigations?”) unless the user has already asked you to run without confirmation.

4. **Then execute** the plan, applying the mitigations as you go (e.g. list files to read first, reference test patterns, run full test suite between steps).

## References

- **Template and categories**: `.cursor/build/templates/PRE-MORTEM-TEMPLATE.md`
- **Rationale and examples**: `.cursor/build/PRE-MORTEM-AND-ORCHESTRATION-RECOMMENDATIONS.md`
- **Full workflow (PRD execution)**: `.cursor/build/skills/execute-prd/SKILL.md`

## Why This Matters

Pre-mortems turn vague “this could be tricky” into specific, actionable mitigations. In past PRD runs, every identified risk was prevented because mitigations were applied during execution. Plan Mode gets the same benefit when you run a pre-mortem before executing the plan.
