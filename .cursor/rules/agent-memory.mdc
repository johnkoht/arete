# Agent Memory Management (BUILDER)

You are an AI assistant building Areté. This rule defines when and how you update build memory — the institutional knowledge that persists across sessions and helps you work effectively with the builder.

---

## Memory Locations

| Content | Location |
|---------|----------|
| Architecture decisions, refactors, tooling changes | `memory/entries/YYYY-MM-DD_slug.md` |
| Collaboration observations (in entry Learnings section) | `memory/entries/YYYY-MM-DD_slug.md` |
| Synthesized builder collaboration profile | `memory/collaboration.md` |
| Index of all entries | `memory/MEMORY.md` |
| "Park this for later" | `now/scratchpad.md` |

**Do not** write to `memory/items/` or `.arete/memory/` — those are product templates for end users.

---

## Leverage Build Memory

Before substantive work:

1. **Read `memory/collaboration.md`** — patterns, preferences, and Corrections to avoid repeat mistakes
2. **Scan `memory/MEMORY.md`** — recent entries relevant to your task
3. **Read specific entries** if the task relates to a documented decision or pattern

This prevents repeating mistakes and ensures you work in a way the builder prefers.

---

## Entry Format

Entries live in `memory/entries/YYYY-MM-DD_slug.md`. Use this structure:

```markdown
# [Title]

**Date**: YYYY-MM-DD
**Type**: [Architecture | Refactor | Tooling | Decision | Bug Fix | ...]
**Files Changed**: [list key files]

## Execution Path

- **Size assessed**: Tiny / Small / Medium / Large
- **Path taken**: Direct / Direct + pre-mortem / PRD
- **Decision tree followed?**: Yes / No / Partially
- **Notes**: [e.g., "Builder chose direct over recommended PRD"]

## Summary

[1-2 sentence description of what changed and why]

## What Changed

[Details of the change — what was added, removed, modified]

## What Worked Well

[Patterns to repeat]

## What Didn't Work

[Patterns to avoid]

## Learnings

[Collaboration observations, builder preferences, corrections, working patterns]

- [Observation] → [Implication]

## Next Steps

[Follow-up work if any]

## References

[Links to related files, PRDs, entries]
```

The **Learnings** section is critical — it captures collaboration observations that feed into `memory/collaboration.md`.

---

## Observation Triggers

Record a collaboration observation in the Learnings section when:

1. **Builder edits your output**: Analyze the diff, note the pattern
   - Example: "Builder removed verbose explanation → preference for concise summaries"

2. **Builder gives explicit feedback**: "I prefer X" or "Don't do Y"
   - Capture immediately with exact wording

3. **Builder corrects you**: "That's not right because..."
   - Note the correction and the reason
   - **Auto-add to Corrections** in `memory/collaboration.md` — no asking required

4. **You notice a pattern**: Same behavior appears 2-3 times
   - Document the pattern you've observed

5. **Builder states a preference**: About process, communication, or tooling
   - Log preferences explicitly

### How to Record

- Include observations in the **Learnings** section of the current build entry
- Format: `- [Observation] → [Implication]`
- Be specific and atomic — one fact per line
- Always tell the builder when you're noting a collaboration observation

---

## Synthesis Triggers

Offer to update `memory/collaboration.md` when:

1. **Several entries** have accumulated learnings about collaboration
2. **After a major build phase** completes (PRD execution, large refactor)
3. **Builder asks** to review or update the profile

### How to Synthesize

1. Review Learnings sections across recent entries
2. Identify patterns that should become profile guidance
3. Update `memory/collaboration.md`:
   - Add new observations to appropriate sections
   - Add corrections to the Corrections section
   - Update "Last Synthesized" date and sources
4. Ask the builder to review

Use the skill: `.agents/skills/synthesize-collaboration-profile/SKILL.md`

---

## Scratchpad Usage

The scratchpad (`now/scratchpad.md`) is a **shared working space** for both builder and agent.

### When to Add to Scratchpad

- Builder says "let's punt on that" or "park it for later"
- Builder explicitly asks to add something
- You have an idea worth capturing but not acting on now
- Questions come up that aren't immediately relevant

**Note**: For mature ideas with a plan, use `dev/backlog/features/` or `dev/backlog/improvements/` instead.

---

## Transparency Rules

1. **Always tell the builder** when saving a collaboration observation
   - "I'm noting that you prefer X — I'll add this to the Learnings section."

2. **Ask before synthesizing** the collaboration profile
   - "I have several new observations. Would you like me to update memory/collaboration.md?"

3. **Ask if work should be added to memory**
   - After substantive work (refactors, decisions, architectural changes), **ask**: "Should I add this to build memory?"
   - Don't add entries without confirming unless the builder has already asked you to record it.

4. **Corrections auto-capture**
   - If builder corrects you, auto-add to Learnings in the current entry AND to the Corrections section of `memory/collaboration.md`. No asking required.

5. **Builder can review and edit** any memory file directly.

---

## Example Interaction

```
Builder: [asks for 3 options before choosing an approach]

Agent: I noticed you prefer seeing multiple options before deciding.
I'll add this to the Learnings section of the current entry:
- Builder prefers 2-3 options before committing → present choices, not prescriptions

I'll offer to update memory/collaboration.md when a few more observations accumulate.
```

---

## Memory Maintenance

- Review Learnings across entries periodically; synthesize into `memory/collaboration.md`
- Keep observations atomic — split compound observations
- Run `.agents/skills/synthesize-collaboration-profile/SKILL.md` after major phases
